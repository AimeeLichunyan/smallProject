<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div id="item">
        点击我
    </div>
    <script>
        // this的指向问题
        // 函数调用
        function say() {
            console.log(this)
        }
        say(); // 函数调用模式this指向全局window
        var item = document.getElementById('item')
        item.addEventListener('click',function() { // 指向item所在的dom结构
            console.log(this)
            var b = function() {
                console.log(this)
            }
            b(); // 函数调用模式this指向全局window
        })
        // 方法调用
        var o = {
            name: 'lichunyan',
            say: function() {
                console.log(this) 
            }
        }
        o.say() // this指向对象o
        var oo = {
            name: 'lichunyan',
            b: {
                name: 'chunyanli',
                sayName: function() {
                    console.log(this)
                }
            }
        }
        console.log('======')
        oo.b.sayName(); // this指向b这个对象
        console.log('====a====')
        var a = oo.b.sayName;
        a();
        console.log('====tt====')
        var tt = oo.b.sayName(); 
        console.log('===console.log===')
        console.log(tt)
        // 构造函数调用
        console.log('使用构造函数')
        function Person() {
            console.log(this)
            this.name = "yanyan"
        }
        var a = new Person();
        console.log(a.name) // yanyan
        function Person2() {
            console.log(this)
            this.name = 'yanyan2';
            return {}
        }
        console.log("当构造函数是一个空对象")
        var a2 = new Person2();
        console.log(a2.name)// undefind
        // 当返回的不是一个对象
        function Person3() {
            console.log(this);
            this.name = 'yanyan3'
            return function() {

            }
        }
        console.log('构造函数返回的不是对象')
        var a3 = new Person3();
        console.log('a3实例返回什么')
        console.log(a3)
        console.log(a3.name)
        console.log('构造函数返回的是数值类型')
        function Person4() {
            console.log(this);
            this.name = 'yanyan4';
            return 3;
        }
        console.log('返回的是一个数值')
        var a4 = new Person4();
        console.log('a4实例返回什么')
        console.log(a4)
        console.log(a4.name)
        console.log('构造函数返回的是undefined')
        function Person5() {
            console.log(this);
            this.name = 'yanyan4';
            return undefined;
        }
        console.log('返回的是一个数值undefined')
        var a4 = new Person5();
        console.log('a5实例返回什么')
        console.log(a4)
        console.log(a4.name)

        console.log('构造函数返回的是array')
        function Person6() {
            console.log(this);
            this.name = 'yanyan4';
            return [];
        }
        console.log('返回的是一个数值array')
        var a6 = new Person6();
        console.log('a6实例返回什么')
        console.log(a6)
        console.log(a6.name)


        // call 和 apply方法改变this指向

        var name = 'chunyan';
        var o = {
            name: 'obj',
        }
        function sayName() {
            console.log(this.name)
        }
        console.log('call 和 apply方法改变this指向')
        sayName(); // chunyan
        sayName.apply(o); // obj
        sayName.call(o) // obj
        sayName.apply(); // chunyan
        sayName.call() // chunyan


        // 练习
        var name = 'chunyan';
        function showName() {
            console.log(this.name)
        }
        var person1 = {
            name: 'person1',
            sayName: showName
        }
        var person2 = {
            name: 'person2',
            sayName: function() {
                var fun = person1.sayName
                fun()
            }
        }
        console.log('person1是什么呢')
        person1.sayName();
        console.log('person2是什么呢')
        person2.sayName();
    </script>
    
</body>
</html>